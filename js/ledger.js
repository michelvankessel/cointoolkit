!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).buffer=t()}}(function(){return function(){return function t(r,e,n){function i(f,u){if(!e[f]){if(!r[f]){var s="function"==typeof require&&require;if(!u&&s)return s(f,!0);if(o)return o(f,!0);var h=new Error("Cannot find module '"+f+"'");throw h.code="MODULE_NOT_FOUND",h}var a=e[f]={exports:{}};r[f][0].call(a.exports,function(t){return i(r[f][1][t]||t)},a,a.exports,t,r,e,n)}return e[f].exports}for(var o="function"==typeof require&&require,f=0;f<n.length;f++)i(n[f]);return i}}()({1:[function(t,r,e){(function(r){"use strict";var n=t("base64-js"),i=t("ieee754");e.Buffer=r,e.SlowBuffer=function(t){+t!=t&&(t=0);return r.alloc(+t)},e.INSPECT_MAX_BYTES=50;var o=2147483647;function f(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=r.prototype,e}function r(t,r,e){if("number"==typeof t){if("string"==typeof r)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,r,e)}function u(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!r.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|c(t,e),i=f(n),o=i.write(t,e);o!==n&&(i=i.slice(0,o));return i}(t,e);if(ArrayBuffer.isView(t))return a(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(z(t,ArrayBuffer)||t&&z(t.buffer,ArrayBuffer))return function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;i=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n);return i.__proto__=r.prototype,i}(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return r.from(i,e,n);var o=function(t){if(r.isBuffer(t)){var e=0|p(t.length),n=f(e);return 0===n.length?n:(t.copy(n,0,0,e),n)}if(void 0!==t.length)return"number"!=typeof t.length||D(t.length)?f(0):a(t);if("Buffer"===t.type&&Array.isArray(t.data))return a(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return r.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return s(t),f(t<0?0:0|p(t))}function a(t){for(var r=t.length<0?0:0|p(t.length),e=f(r),n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function c(t,e){if(r.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(t).length;default:if(o)return i?-1:N(t).length;e=(""+e).toLowerCase(),o=!0}}function l(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function y(t,e,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),D(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=r.from(e,i)),r.isBuffer(e))return 0===e.length?-1:g(t,e,n,i,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,i,o);throw new TypeError("val must be string, number or Buffer")}function g(t,r,e,n,i){var o,f=1,u=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;f=2,u/=2,s/=2,e/=2}function h(t,r){return 1===f?t[r]:t.readUInt16BE(r*f)}if(i){var a=-1;for(o=e;o<u;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*f}else-1!==a&&(o-=o-a),a=-1}else for(e+s>u&&(e=u-s),o=e;o>=0;o--){for(var p=!0,c=0;c<s;c++)if(h(t,o+c)!==h(r,c)){p=!1;break}if(p)return o}return-1}function w(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;n>o/2&&(n=o/2);for(var f=0;f<n;++f){var u=parseInt(r.substr(2*f,2),16);if(D(u))return f;t[e+f]=u}return f}function d(t,r,e,n){return j(N(r,t.length-e),t,e,n)}function v(t,r,e,n){return j(function(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(r),t,e,n)}function b(t,r,e,n){return v(t,r,e,n)}function m(t,r,e,n){return j(P(r),t,e,n)}function E(t,r,e,n){return j(function(t,r){for(var e,n,i,o=[],f=0;f<t.length&&!((r-=2)<0);++f)e=t.charCodeAt(f),n=e>>8,i=e%256,o.push(i),o.push(n);return o}(r,t.length-e),t,e,n)}function A(t,r,e){return 0===r&&e===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(r,e))}function B(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,f,u,s,h=t[i],a=null,p=h>239?4:h>223?3:h>191?2:1;if(i+p<=e)switch(p){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],f=t[i+2],128==(192&o)&&128==(192&f)&&(s=(15&h)<<12|(63&o)<<6|63&f)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],f=t[i+2],u=t[i+3],128==(192&o)&&128==(192&f)&&128==(192&u)&&(s=(15&h)<<18|(63&o)<<12|(63&f)<<6|63&u)>65535&&s<1114112&&(a=s)}null===a?(a=65533,p=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=p}return function(t){var r=t.length;if(r<=U)return String.fromCharCode.apply(String,t);var e="",n=0;for(;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=U));return e}(n)}e.kMaxLength=o,r.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),r.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(t,r,e){return u(t,r,e)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(t,r,e){return function(t,r,e){return s(t),t<=0?f(t):void 0!==r?"string"==typeof e?f(t).fill(r,e):f(t).fill(r):f(t)}(t,r,e)},r.allocUnsafe=function(t){return h(t)},r.allocUnsafeSlow=function(t){return h(t)},r.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==r.prototype},r.compare=function(t,e){if(z(t,Uint8Array)&&(t=r.from(t,t.offset,t.byteLength)),z(e,Uint8Array)&&(e=r.from(e,e.offset,e.byteLength)),!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,i=e.length,o=0,f=Math.min(n,i);o<f;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return r.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=r.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var f=t[n];if(z(f,Uint8Array)&&(f=r.from(f)),!r.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(i,o),o+=f.length}return i},r.byteLength=c,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)l(this,r,r+1);return this},r.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)l(this,r,r+3),l(this,r+1,r+2);return this},r.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)l(this,r,r+7),l(this,r+1,r+6),l(this,r+2,r+5),l(this,r+3,r+4);return this},r.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):function(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,r,e);case"utf8":case"utf-8":return B(this,r,e);case"ascii":return _(this,r,e);case"latin1":case"binary":return T(this,r,e);case"base64":return A(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r.prototype.compare=function(t,e,n,i,o){if(z(t,Uint8Array)&&(t=r.from(t,t.offset,t.byteLength)),!r.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var f=(o>>>=0)-(i>>>=0),u=(n>>>=0)-(e>>>=0),s=Math.min(f,u),h=this.slice(i,o),a=t.slice(e,n),p=0;p<s;++p)if(h[p]!==a[p]){f=h[p],u=a[p];break}return f<u?-1:u<f?1:0},r.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},r.prototype.indexOf=function(t,r,e){return y(this,t,r,e,!0)},r.prototype.lastIndexOf=function(t,r,e){return y(this,t,r,e,!1)},r.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(e)?(e>>>=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,t,r,e);case"utf8":case"utf-8":return d(this,t,r,e);case"ascii":return v(this,t,r,e);case"latin1":case"binary":return b(this,t,r,e);case"base64":return m(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var U=4096;function _(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function T(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function I(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=k(t[o]);return i}function S(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,n,i,o,f){if(!r.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<f)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function R(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function x(t,r,e,n,o){return r=+r,e>>>=0,o||R(t,0,e,4),i.write(t,r,e,n,23,4),e+4}function M(t,r,e,n,o){return r=+r,e>>>=0,o||R(t,0,e,8),i.write(t,r,e,n,52,8),e+8}r.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var i=this.subarray(t,e);return i.__proto__=r.prototype,i},r.prototype.readUIntLE=function(t,r,e){t>>>=0,r>>>=0,e||C(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},r.prototype.readUIntBE=function(t,r,e){t>>>=0,r>>>=0,e||C(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},r.prototype.readUInt8=function(t,r){return t>>>=0,r||C(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,r){return t>>>=0,r||C(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,r){return t>>>=0,r||C(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,r){return t>>>=0,r||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,r){return t>>>=0,r||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,r,e){t>>>=0,r>>>=0,e||C(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},r.prototype.readIntBE=function(t,r,e){t>>>=0,r>>>=0,e||C(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},r.prototype.readInt8=function(t,r){return t>>>=0,r||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,r){t>>>=0,r||C(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},r.prototype.readInt16BE=function(t,r){t>>>=0,r||C(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},r.prototype.readInt32LE=function(t,r){return t>>>=0,r||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,r){return t>>>=0,r||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,r){return t>>>=0,r||C(t,4,this.length),i.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,r){return t>>>=0,r||C(t,4,this.length),i.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,r){return t>>>=0,r||C(t,8,this.length),i.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,r){return t>>>=0,r||C(t,8,this.length),i.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r>>>=0,e>>>=0,n)||L(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},r.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r>>>=0,e>>>=0,n)||L(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},r.prototype.writeUInt8=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,1,255,0),this[r]=255&t,r+1},r.prototype.writeUInt16LE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,2,65535,0),this[r]=255&t,this[r+1]=t>>>8,r+2},r.prototype.writeUInt16BE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,2,65535,0),this[r]=t>>>8,this[r+1]=255&t,r+2},r.prototype.writeUInt32LE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,4,4294967295,0),this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t,r+4},r.prototype.writeUInt32BE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,4,4294967295,0),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t,r+4},r.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r>>>=0,!n){var i=Math.pow(2,8*e-1);L(this,t,r,e,i-1,-i)}var o=0,f=1,u=0;for(this[r]=255&t;++o<e&&(f*=256);)t<0&&0===u&&0!==this[r+o-1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},r.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r>>>=0,!n){var i=Math.pow(2,8*e-1);L(this,t,r,e,i-1,-i)}var o=e-1,f=1,u=0;for(this[r+o]=255&t;--o>=0&&(f*=256);)t<0&&0===u&&0!==this[r+o+1]&&(u=1),this[r+o]=(t/f>>0)-u&255;return r+e},r.prototype.writeInt8=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,1,127,-128),t<0&&(t=255+t+1),this[r]=255&t,r+1},r.prototype.writeInt16LE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,2,32767,-32768),this[r]=255&t,this[r+1]=t>>>8,r+2},r.prototype.writeInt16BE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,2,32767,-32768),this[r]=t>>>8,this[r+1]=255&t,r+2},r.prototype.writeInt32LE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,4,2147483647,-2147483648),this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24,r+4},r.prototype.writeInt32BE=function(t,r,e){return t=+t,r>>>=0,e||L(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t,r+4},r.prototype.writeFloatLE=function(t,r,e){return x(this,t,r,!0,e)},r.prototype.writeFloatBE=function(t,r,e){return x(this,t,r,!1,e)},r.prototype.writeDoubleLE=function(t,r,e){return M(this,t,r,!0,e)},r.prototype.writeDoubleBE=function(t,r,e){return M(this,t,r,!1,e)},r.prototype.copy=function(t,e,n,i){if(!r.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o=i-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,i);else if(this===t&&n<e&&e<i)for(var f=o-1;f>=0;--f)t[f+e]=this[f+n];else Uint8Array.prototype.set.call(t,this.subarray(n,i),e);return o},r.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!r.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var f;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(f=e;f<n;++f)this[f]=t;else{var u=r.isBuffer(t)?t:r.from(t,i),s=u.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(f=0;f<n-e;++f)this[f+e]=u[f%s]}return this};var O=/[^+\/0-9A-Za-z-_]/g;function k(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],f=0;f<n;++f){if((e=t.charCodeAt(f))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(f+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function P(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function j(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function z(t,r){return t instanceof r||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===r.name}function D(t){return t!=t}}).call(this,t("buffer").Buffer)},{"base64-js":2,buffer:5,ieee754:3}],2:[function(t,r,e){"use strict";e.byteLength=function(t){var r=h(t),e=r[0],n=r[1];return 3*(e+n)/4-n},e.toByteArray=function(t){for(var r,e=h(t),n=e[0],f=e[1],u=new o(function(t,r,e){return 3*(r+e)/4-e}(0,n,f)),s=0,a=f>0?n-4:n,p=0;p<a;p+=4)r=i[t.charCodeAt(p)]<<18|i[t.charCodeAt(p+1)]<<12|i[t.charCodeAt(p+2)]<<6|i[t.charCodeAt(p+3)],u[s++]=r>>16&255,u[s++]=r>>8&255,u[s++]=255&r;2===f&&(r=i[t.charCodeAt(p)]<<2|i[t.charCodeAt(p+1)]>>4,u[s++]=255&r);1===f&&(r=i[t.charCodeAt(p)]<<10|i[t.charCodeAt(p+1)]<<4|i[t.charCodeAt(p+2)]>>2,u[s++]=r>>8&255,u[s++]=255&r);return u},e.fromByteArray=function(t){for(var r,e=t.length,i=e%3,o=[],f=0,u=e-i;f<u;f+=16383)o.push(a(t,f,f+16383>u?u:f+16383));1===i?(r=t[e-1],o.push(n[r>>2]+n[r<<4&63]+"==")):2===i&&(r=(t[e-2]<<8)+t[e-1],o.push(n[r>>10]+n[r>>4&63]+n[r<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,s=f.length;u<s;++u)n[u]=f[u],i[f.charCodeAt(u)]=u;function h(t){var r=t.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=t.indexOf("=");return-1===e&&(e=r),[e,e===r?0:4-e%4]}function a(t,r,e){for(var i,o,f=[],u=r;u<e;u+=3)i=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),f.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return f.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],3:[function(t,r,e){e.read=function(t,r,e,n,i){var o,f,u=8*i-n-1,s=(1<<u)-1,h=s>>1,a=-7,p=e?i-1:0,c=e?-1:1,l=t[r+p];for(p+=c,o=l&(1<<-a)-1,l>>=-a,a+=u;a>0;o=256*o+t[r+p],p+=c,a-=8);for(f=o&(1<<-a)-1,o>>=-a,a+=n;a>0;f=256*f+t[r+p],p+=c,a-=8);if(0===o)o=1-h;else{if(o===s)return f?NaN:1/0*(l?-1:1);f+=Math.pow(2,n),o-=h}return(l?-1:1)*f*Math.pow(2,o-n)},e.write=function(t,r,e,n,i,o){var f,u,s,h=8*o-i-1,a=(1<<h)-1,p=a>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,y=n?1:-1,g=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,f=a):(f=Math.floor(Math.log(r)/Math.LN2),r*(s=Math.pow(2,-f))<1&&(f--,s*=2),(r+=f+p>=1?c/s:c*Math.pow(2,1-p))*s>=2&&(f++,s/=2),f+p>=a?(u=0,f=a):f+p>=1?(u=(r*s-1)*Math.pow(2,i),f+=p):(u=r*Math.pow(2,p-1)*Math.pow(2,i),f=0));i>=8;t[e+l]=255&u,l+=y,u/=256,i-=8);for(f=f<<i|u,h+=i;h>0;t[e+l]=255&f,l+=y,f/=256,h-=8);t[e+l-y]|=128*g}},{}],4:[function(t,r,e){arguments[4][2][0].apply(e,arguments)},{dup:2}],5:[function(t,r,e){arguments[4][1][0].apply(e,arguments)},{"base64-js":4,buffer:5,dup:1,ieee754:6}],6:[function(t,r,e){arguments[4][3][0].apply(e,arguments)},{dup:3}]},{},[1])(1)});
window.global = window;
window.Buffer = buffer.Buffer;

!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.NewLedger={})}(this,function(e){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,r){return e(r={exports:{}},r.exports),r.exports}n(function(e){var r=function(e){var r,t=Object.prototype,n=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{u({},"")}catch(e){u=function(e,r,t){return e[r]=t}}function c(e,r,t,n){var o=r&&r.prototype instanceof g?r:g,a=Object.create(o.prototype),i=new A(n||[]);return a._invoke=function(e,r,t){var n=f;return function(o,a){if(n===p)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw a;return N()}for(t.method=o,t.arg=a;;){var i=t.delegate;if(i){var s=D(i,t);if(s){if(s===v)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(n===f)throw n=h,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n=p;var u=l(e,r,t);if("normal"===u.type){if(n=t.done?h:d,u.arg===v)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(n=h,t.method="throw",t.arg=u.arg)}}}(e,t,i),a}function l(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",h="completed",v={};function g(){}function m(){}function E(){}var y={};u(y,a,function(){return this});var C=Object.getPrototypeOf,w=C&&C(C(x([])));w&&w!==t&&n.call(w,a)&&(y=w);var I=E.prototype=g.prototype=Object.create(y);function b(e){["next","throw","return"].forEach(function(r){u(e,r,function(e){return this._invoke(r,e)})})}function B(e,r){var t;this._invoke=function(o,a){function i(){return new r(function(t,i){!function t(o,a,i,s){var u=l(e[o],e,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?r.resolve(f.__await).then(function(e){t("next",e,i,s)},function(e){t("throw",e,i,s)}):r.resolve(f).then(function(e){c.value=e,i(c)},function(e){return t("throw",e,i,s)})}s(u.arg)}(o,a,t,i)})}return t=t?t.then(i,i):i()}}function D(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,D(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,v;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function T(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function S(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function x(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return i.next=i}}return{next:N}}function N(){return{value:r,done:!0}}return m.prototype=E,u(I,"constructor",E),u(E,"constructor",m),m.displayName=u(E,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,u(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},b(B.prototype),u(B.prototype,i,function(){return this}),e.AsyncIterator=B,e.async=function(r,t,n,o,a){void 0===a&&(a=Promise);var i=new B(c(r,t,n,o),a);return e.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},b(I),u(I,s,"Generator"),u(I,a,function(){return this}),u(I,"toString",function(){return"[object Generator]"}),e.keys=function(e){var r=[];for(var t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=x,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return s.type="throw",s.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),S(t),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var o=n.arg;S(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),v}},e}(e.exports);try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}});var o=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.defer=function(){var e=void 0,r=void 0,t=new Promise(function(t,n){e=t,r=n});if(!e||!r)throw"defer() error";return{promise:t,resolve:e,reject:r}},r.splitPath=function(e){var r=[];return e.split("/").forEach(function(e){var t=parseInt(e,10);isNaN(t)||(e.length>1&&"'"===e[e.length-1]&&(t+=2147483648),r.push(t))}),r},r.eachSeries=function(e,r){return e.reduce(function(e,t){return e.then(function(){return r(t)})},Promise.resolve())},r.foreach=function(e,r){return Promise.resolve().then(function(){return function e(t,n,o){return t>=n.length?o:r(n[t],t).then(function(r){return o.push(r),e(t+1,n,o)})}(0,e,[])})},r.doIf=function(e,r){return Promise.resolve().then(function(){if(e)return r()})},r.asyncWhile=function(e,r){return Promise.resolve([]).then(function t(n){return e()?r().then(function(e){return n.push(e),t(n)}):n})};r.isLedgerDevice=function(e){return 9601===e.vendorId&&15228===e.productId||11415===e.vendorId}});t(o);o.defer,o.splitPath,o.eachSeries,o.foreach,o.doIf,o.asyncWhile,o.isLedgerDevice;var a={}.createHash,i=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t,n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),s=(t=a)&&t.__esModule?t:{default:t};var u={legacy:0,p2sh:1,bech32:2},c=function(){function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BTC";!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.transport=r,r.decorateAppAPIMethods(this,["getWalletPublicKey","signP2SHTransaction","signMessageNew","createPaymentTransactionNew"],t)}return i(e,[{key:"hashPublicKey",value:function(e){return(0,s.default)("rmd160").update((0,s.default)("sha256").update(e).digest()).digest()}},{key:"getWalletPublicKey_private",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n({verify:!1,format:"legacy"},r),a=t.verify,i=t.format;if(!(i in u))throw new Error("btc.getWalletPublicKey invalid format="+i);var s=(0,o.splitPath)(e),c=a?1:0,l=u[i],f=Buffer.alloc(1+4*s.length);return f[0]=s.length,s.forEach(function(e,r){f.writeUInt32BE(e,1+4*r)}),this.transport.send(224,64,c,l,f).then(function(e){var r=e[0],t=e[1+r];return{publicKey:e.slice(1,1+r).toString("hex"),bitcoinAddress:e.slice(1+r+1,1+r+1+t).toString("ascii"),chainCode:e.slice(1+r+1+t,1+r+1+t+32).toString("hex")}})}},{key:"getWalletPublicKey",value:function(e,r){var t=void 0;return arguments.length>2||"boolean"==typeof r?(console.warn("btc.getWalletPublicKey deprecated signature used. Please switch to getWalletPublicKey(path, { format, verify })"),t={verify:!!r,format:arguments[2]?"p2sh":"legacy"}):t=r||{},this.getWalletPublicKey_private(e,t)}},{key:"getTrustedInputRaw",value:function(e,r){var t=void 0,n=!1;if("number"==typeof r){n=!0;var o=Buffer.alloc(4);o.writeUInt32BE(r,0),t=Buffer.concat([o,e],e.length+4)}else t=e;return this.transport.send(224,66,n?0:128,0,t).then(function(e){return e.slice(0,e.length-2).toString("hex")})}},{key:"getTrustedInput",value:function(e,r){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=r.inputs,i=r.outputs,s=r.locktime;if(!i||!s)throw new Error("getTrustedInput: locktime & outputs is expected");var u=n.includes("decred"),c=n.includes("stealthcoin"),l=function(e){return t.getTrustedInputRaw(e)},f=Buffer.concat([r.version,r.timestamp||Buffer.alloc(0),this.createVarint(a.length)]);return this.getTrustedInputRaw(f,e).then(function(){return(0,o.eachSeries)(a,function(e){var r=u?e.tree||Buffer.from([0]):Buffer.alloc(0),n=Buffer.concat([e.prevout,r,c?Buffer.from([0]):t.createVarint(e.script.length)]);return t.getTrustedInputRaw(n).then(function(){return u?l(Buffer.concat([e.script,e.sequence])):c?l(e.sequence):function(e,r){for(var n=[],a=0;a!==e.length;){var i=e.length-a>50?50:e.length-a;a+i!==e.length?n.push(e.slice(a,a+i)):n.push(Buffer.concat([e.slice(a,a+i),r])),a+=i}return 0===e.length&&n.push(r),(0,o.eachSeries)(n,function(e){return t.getTrustedInputRaw(e)})}(e.script,e.sequence)})}).then(function(){var e=t.createVarint(i.length);return t.getTrustedInputRaw(e)})}).then(function(){return(0,o.eachSeries)(i,function(e){var r=e.amount;return r=Buffer.concat([r,u?Buffer.from([0,0]):Buffer.alloc(0),t.createVarint(e.script.length),e.script]),t.getTrustedInputRaw(r).then(function(){})}).then(function(){var e=u?Buffer.concat([s,Buffer.from([0,0,0,0])]):s;return t.getTrustedInputRaw(e)})})}},{key:"getTrustedInputBIP143",value:function(){var e,r=(e=regeneratorRuntime.mark(function e(r,t){var n,o,a,i,u,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("getTrustedInputBIP143: missing tx");case 2:if(!c.includes("decred")){e.next=5;break}throw new Error("Decred does not implement BIP143");case 5:if((n=(0,s.default)("sha256")).update(this.serializeTransaction(t,!0)),o=n.digest(),(n=(0,s.default)("sha256")).update(o),o=n.digest(),(a=Buffer.alloc(4)).writeUInt32LE(r,0),i=t.outputs,u=t.locktime,i&&u){e.next=16;break}throw new Error("getTrustedInputBIP143: locktime & outputs is expected");case 16:if(i[r]){e.next=18;break}throw new Error("getTrustedInputBIP143: wrong index");case 18:return o=Buffer.concat([o,a,i[r].amount]),e.next=21,o.toString("hex");case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}},e,this)}),function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,a){try{var i=r[o](a),s=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})});return function(e,t){return r.apply(this,arguments)}}()},{key:"getVarint",value:function(e,r){if(e[r]<253)return[e[r],1];if(253===e[r])return[(e[r+2]<<8)+e[r+1],3];if(254===e[r])return[(e[r+4]<<24)+(e[r+3]<<16)+(e[r+2]<<8)+e[r+1],5];throw new Error("getVarint called with unexpected parameters")}},{key:"startUntrustedHashTransactionInputRaw",value:function(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],i=n?a.includes("sapling")?5:o?4:2:0;return this.transport.send(224,68,r?0:128,e?i:128,t)}},{key:"startUntrustedHashTransactionInput",value:function(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=Buffer.concat([r.version,r.timestamp||Buffer.alloc(0),r.nVersionGroupId||Buffer.alloc(0),this.createVarint(r.inputs.length)]);return this.startUntrustedHashTransactionInputRaw(e,!0,u,n,i,s).then(function(){var c=0,l=s.includes("decred");return(0,o.eachSeries)(r.inputs,function(r){var f=void 0;return f=n?Buffer.from([2]):t[c].trustedInput?Buffer.from([1,t[c].value.length]):Buffer.from([0]),u=Buffer.concat([f,t[c].value,l?Buffer.from([0]):Buffer.alloc(0),a.createVarint(r.script.length)]),a.startUntrustedHashTransactionInputRaw(e,!1,u,n,i,s).then(function(){var t=[],u=0;if(0===r.script.length)t.push(r.sequence);else for(;u!==r.script.length;){var l=r.script.length-u>50?50:r.script.length-u;u+l!==r.script.length?t.push(r.script.slice(u,u+l)):t.push(Buffer.concat([r.script.slice(u,u+l),r.sequence])),u+=l}return(0,o.eachSeries)(t,function(r){return a.startUntrustedHashTransactionInputRaw(e,!1,r,n,i,s)}).then(function(){c++})})})})}},{key:"provideOutputFullChangePath",value:function(e){var r=(0,o.splitPath)(e),t=Buffer.alloc(1+4*r.length);return t[0]=r.length,r.forEach(function(e,r){t.writeUInt32BE(e,1+4*r)}),this.transport.send(224,74,255,0,t)}},{key:"hashOutputFull",value:function(e){var r=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;return t.includes("decred")?this.transport.send(224,74,128,0,e):(0,o.asyncWhile)(function(){return n<e.length},function(){var t=n+50>=e.length?e.length-n:50,o=n+t===e.length?128:0,a=e.slice(n,n+t);return r.transport.send(224,74,o,0,a).then(function(){n+=t})})}},{key:"signTransaction",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments[3],a=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:[]).includes("decred"),i=(0,o.splitPath)(e),s=0,u=Buffer.alloc(4*i.length);i.forEach(function(e){u.writeUInt32BE(e,s),s+=4});var c=Buffer.alloc(4);c.writeUInt32BE(r,0);var l=a?Buffer.concat([Buffer.from([i.length]),u,c,n||Buffer.from([0,0,0,0]),Buffer.from([t])]):Buffer.concat([Buffer.from([i.length]),u,Buffer.from([0]),c,Buffer.from([t])]);return n&&!a&&(l=Buffer.concat([l,n])),this.transport.send(224,72,0,0,l).then(function(e){return e.length>0?(e[0]=48,e.slice(0,e.length-2)):e})}},{key:"signMessageNew",value:function(e,r){for(var t=this,n=(0,o.splitPath)(e),a=new Buffer(r,"hex"),i=0,s=[],u=function(){var e=0===i?49-4*n.length-4:50,r=i+e>a.length?a.length-i:e,t=new Buffer(0===i?1+4*n.length+2+r:r);0===i?(t[0]=n.length,n.forEach(function(e,r){t.writeUInt32BE(e,1+4*r)}),t.writeUInt16BE(a.length,1+4*n.length),a.copy(t,1+4*n.length+2,i,i+r)):a.copy(t,0,i,i+r),s.push(t),i+=r};i!==a.length;)u();return(0,o.foreach)(s,function(e,r){return t.transport.send(224,78,0,0===r?1:128,e)}).then(function(){return t.transport.send(224,78,128,0,Buffer.from([0])).then(function(e){var r=e[0]-48,t=e.slice(4,4+e[3]);0===t[0]&&(t=t.slice(1)),t=t.toString("hex");var n=4+e[3]+2,o=e.slice(n,n+e[n-1]);return 0===o[0]&&(o=o.slice(1)),{v:r,r:t,s:o=o.toString("hex")}})})}},{key:"createPaymentTransactionNew",value:function(e,r,t,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments[7],l=this,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],d=arguments[9],p=f.includes("decred"),h=f.includes("stealthcoin"),v=void 0!==c,g=Date.now(),m=f.includes("sapling"),E=u&&f.includes("bech32"),y=u||!!f&&(f.includes("abc")||f.includes("gold")||f.includes("bip143"))||!!d&&!p,C=Buffer.alloc(0),w=Buffer.alloc(0),I=Buffer.alloc(4);d&&!p?I.writeUInt32LE(m?2147483652:2147483651,0):h?I.writeUInt32LE(2,0):I.writeUInt32LE(1,0);var b=[],B=[],D=[],T=[],S=!0,A={inputs:[],version:I,timestamp:Buffer.alloc(0)},x=y?this.getTrustedInputBIP143.bind(this):this.getTrustedInput.bind(this),N=Buffer.from(a,"hex");return(0,o.foreach)(e,function(e){return(0,o.doIf)(!0,function(){return x(e[1],e[0],f).then(function(r){var t=Buffer.alloc(4);t.writeUInt32LE(e.length>=4&&"number"==typeof e[3]?e[3]:4294967295,0),b.push({trustedInput:!0,value:Buffer.from(r,"hex"),sequence:t})})}).then(function(){var r=e[0].outputs,t=e[1];r&&t<=r.length-1&&B.push(r[t])}).then(function(){d&&!p?(A.nVersionGroupId=Buffer.from(m?[133,32,47,137]:[112,130,196,3]),A.nExpiryHeight=d,A.extraData=Buffer.from(m?[0,0,0,0,0,0,0,0,0,0,0]:[0])):p&&(A.nExpiryHeight=d)})}).then(function(){for(var r=0;r<e.length;r++){var t=Buffer.alloc(4);t.writeUInt32LE(e[r].length>=4&&"number"==typeof e[r][3]?e[r][3]:4294967295,0),A.inputs.push({script:C,prevout:w,sequence:t})}}).then(function(){return(0,o.doIf)(!0,function(){return(0,o.foreach)(e,function(e,t){return l.getWalletPublicKey_private(r[t])}).then(function(e){for(var r=0;r<e.length;r++)T.push(l.compressPublicKey(Buffer.from(e[r].publicKey,"hex")))})})}).then(function(){v&&(A.timestamp=Buffer.alloc(4),A.timestamp.writeUInt32LE(Math.floor(c+(Date.now()-g)/1e3),0))}).then(function(){return(0,o.doIf)(y,function(){return l.startUntrustedHashTransactionInput(!0,A,b,!0,!!d,f).then(function(){return(0,o.doIf)(void 0!==t,function(){return l.provideOutputFullChangePath(t)}).then(function(){return l.hashOutputFull(N)})})})}).then(function(){return(0,o.doIf)(!!d&&!p,function(){return l.signTransaction("",i,1,d)})}).then(function(){return(0,o.foreach)(e,function(a,c){var h=e[c].length>=3&&"string"==typeof e[c][2]?Buffer.from(e[c][2],"hex"):u?Buffer.concat([Buffer.from([118,169,20]),l.hashPublicKey(T[c]),Buffer.from([136,172])]):B[c].script,v=Object.assign({},A),g=y?[b[c]]:b;return y?v.inputs=[n({},v.inputs[c],{script:h})]:v.inputs[c].script=h,l.startUntrustedHashTransactionInput(!y&&S,v,g,y,!!d&&!p,f).then(function(){return(0,o.doIf)(!y,function(){return(0,o.doIf)(void 0!==t,function(){return l.provideOutputFullChangePath(t)}).then(function(){return l.hashOutputFull(N,f)})})}).then(function(){return l.signTransaction(r[c],i,s,d,f)}).then(function(e){D.push(e),A.inputs[c].script=C,S&&(S=!1)})})}).then(function(){for(var r=0;r<e.length;r++){if(u)A.witness=Buffer.alloc(0),E||(A.inputs[r].script=Buffer.concat([Buffer.from("160014","hex"),l.hashPublicKey(T[r])]));else{var t=Buffer.alloc(1),n=Buffer.alloc(1);t[0]=D[r].length,n[0]=T[r].length,A.inputs[r].script=Buffer.concat([t,D[r],n,T[r]])}var o=y?0:4;A.inputs[r].prevout=b[r].value.slice(o,o+36)}var a=Buffer.alloc(4);a.writeUInt32LE(i,0);var s=Buffer.concat([l.serializeTransaction(A,!1,A.timestamp,f),N]);if(u&&!p){for(var c=Buffer.alloc(0),h=0;h<e.length;h++){var v=Buffer.concat([Buffer.from("02","hex"),Buffer.from([D[h].length]),D[h],Buffer.from([T[h].length]),T[h]]);c=Buffer.concat([c,v])}s=Buffer.concat([s,c])}if(s=Buffer.concat([s,a]),d&&(s=Buffer.concat([s,A.nExpiryHeight||Buffer.alloc(0),A.extraData||Buffer.alloc(0)])),p){var g=Buffer.from([A.inputs.length]);e.forEach(function(e,r){g=Buffer.concat([g,Buffer.from([0,0,0,0,0,0,0,0]),Buffer.from([0,0,0,0]),Buffer.from([255,255,255,255]),Buffer.from([A.inputs[r].script.length]),A.inputs[r].script])}),s=Buffer.concat([s,g])}return s.toString("hex")})}},{key:"signP2SHTransaction",value:function(e,r,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=this,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=Buffer.alloc(0),d=Buffer.alloc(0),p=Buffer.alloc(4);p.writeUInt32LE(c,0);var h=Buffer.alloc(4);h.writeUInt32LE(l,0);var v=[],g=[],m=[],E=!0,y={inputs:[],version:p};l>0&&(y.timestamp=h);var C=s?this.getTrustedInputBIP143.bind(this):this.getTrustedInput.bind(this),w=Buffer.from(t,"hex");return(0,o.foreach)(e,function(e){return(0,o.doIf)(!0,function(){return C(e[1],e[0]).then(function(r){var t=Buffer.alloc(4);t.writeUInt32LE(e.length>=4&&"number"==typeof e[3]?e[3]:4294967295,0),v.push({trustedInput:!1,value:s?Buffer.from(r,"hex"):Buffer.from(r,"hex").slice(4,40),sequence:t})})}).then(function(){var r=e[0].outputs,t=e[1];r&&t<=r.length-1&&g.push(r[t])})}).then(function(){for(var r=0;r<e.length;r++){var t=Buffer.alloc(4);t.writeUInt32LE(e[r].length>=4&&"number"==typeof e[r][3]?e[r][3]:4294967295,0),y.inputs.push({script:f,prevout:d,sequence:t})}}).then(function(){return(0,o.doIf)(s,function(){return u.startUntrustedHashTransactionInput(!0,y,v,!0).then(function(){return u.hashOutputFull(w)})})}).then(function(){return(0,o.foreach)(e,function(t,c){var l=e[c].length>=3&&"string"==typeof e[c][2]?Buffer.from(e[c][2],"hex"):g[c].script,d=Object.assign({},y),p=s?[v[c]]:v;return s?d.inputs=[n({},d.inputs[c],{script:l})]:d.inputs[c].script=l,u.startUntrustedHashTransactionInput(!s&&E,d,p,s).then(function(){return(0,o.doIf)(!s,function(){return u.hashOutputFull(w)})}).then(function(){return u.signTransaction(r[c],a,i).then(function(e){m.push(e.toString("hex")),y.inputs[c].script=f,E&&(E=!1)})})})}).then(function(){return m})}},{key:"compressPublicKey",value:function(e){var r=0!=(1&e[64])?3:2,t=Buffer.alloc(1);return t[0]=r,Buffer.concat([t,e.slice(1,33)])}},{key:"createVarint",value:function(e){if(e<253){var r=Buffer.alloc(1);return r[0]=e,r}if(e<=65535){var t=Buffer.alloc(3);return t[0]=253,t[1]=255&e,t[2]=e>>8&255,t}var n=Buffer.alloc(5);return n[0]=254,n[1]=255&e,n[2]=e>>8&255,n[3]=e>>16&255,n[4]=e>>24&255,n}},{key:"splitTransaction",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=[],i=[],s=!1,u=0,c=Buffer.alloc(0),l=Buffer.alloc(0),f=Buffer.alloc(0),d=Buffer.alloc(0),p=o.includes("decred"),h=Buffer.from(e,"hex"),v=h.slice(u,u+4),g=v.equals(Buffer.from([3,0,0,128]))||v.equals(Buffer.from([4,0,0,128]));u+=4,!t&&r&&0===h[u]&&0!==h[u+1]&&(u+=2,s=!0),t&&(c=h.slice(u,4+u),u+=4),g&&(f=h.slice(u,4+u),u+=4);var m=this.getVarint(h,u),E=m[0];u+=m[1];for(var y=0;y<E;y++){var C=h.slice(u,u+36);u+=36;var w=Buffer.alloc(0),I=Buffer.alloc(0);p?(I=h.slice(u,u+1),u+=1):(u+=(m=this.getVarint(h,u))[1],w=h.slice(u,u+m[0]),u+=m[0]);var b=h.slice(u,u+4);u+=4,a.push({prevout:C,script:w,sequence:b,tree:I})}var B=(m=this.getVarint(h,u))[0];u+=m[1];for(var D=0;D<B;D++){var T=h.slice(u,u+8);u+=8,p&&(u+=2),u+=(m=this.getVarint(h,u))[1];var S=h.slice(u,u+m[0]);u+=m[0],i.push({amount:T,script:S})}var A=void 0,x=void 0;if(s?(A=h.slice(u,-4),x=h.slice(h.length-4)):x=h.slice(u,u+4),u+=4,(g||p)&&(l=h.slice(u,u+4),u+=4),n&&(d=h.slice(u)),p){if(u+=(m=this.getVarint(h,u))[1],m[0]!==E)throw new Error("splitTransaction: incoherent number of witnesses");for(var N=0;N<E;N++){u+=8,u+=4,u+=4,u+=(m=this.getVarint(h,u))[1];var U=h.slice(u,u+m[0]);u+=m[0],a[N].script=U}}return{version:v,inputs:a,outputs:i,locktime:x,witness:A,timestamp:c,nVersionGroupId:f,nExpiryHeight:l,extraData:d}}},{key:"serializeTransactionOutputs",value:function(e){var r=this,t=e.outputs,n=Buffer.alloc(0);return void 0!==t&&(n=Buffer.concat([n,this.createVarint(t.length)]),t.forEach(function(e){n=Buffer.concat([n,e.amount,r.createVarint(e.script.length),e.script])})),n}},{key:"serializeTransaction",value:function(e,r,t){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=o.includes("decred"),i=o.includes("bech32"),s=Buffer.alloc(0),u=void 0!==e.witness&&!r;e.inputs.forEach(function(e){s=a||i?Buffer.concat([s,e.prevout,Buffer.from([0]),e.sequence]):Buffer.concat([s,e.prevout,n.createVarint(e.script.length),e.script,e.sequence])});var c=this.serializeTransactionOutputs(e);return void 0!==e.outputs&&void 0!==e.locktime&&(c=Buffer.concat([c,u&&e.witness||Buffer.alloc(0),e.locktime,e.nExpiryHeight||Buffer.alloc(0),e.extraData||Buffer.alloc(0)])),Buffer.concat([e.version,t||Buffer.alloc(0),e.nVersionGroupId||Buffer.alloc(0),u?Buffer.from("0001","hex"):Buffer.alloc(0),this.createVarint(e.inputs.length),s,c])}},{key:"displayTransactionDebug",value:function(e){console.log("version "+e.version.toString("hex")),e.inputs.forEach(function(e,r){var t=e.prevout.toString("hex"),n=e.script.toString("hex"),o=e.sequence.toString("hex");console.log("input "+r+" prevout "+t+" script "+n+" sequence "+o)}),(e.outputs||[]).forEach(function(e,r){var t=e.amount.toString("hex"),n=e.script.toString("hex");console.log("output "+r+" amount "+t+" script "+n)}),void 0!==e.locktime&&console.log("locktime "+e.locktime.toString("hex"))}}]),e}();r.default=c}),s=t(i),u=Object.freeze({default:s,__moduleExports:i});function c(){}function l(){l.init.call(this)}function f(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners}function d(e,r,t,n){var o,a,i,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",r,t.listener?t.listener:t),a=e._events),i=a[r]):(a=e._events=new c,e._eventsCount=0),i){if("function"==typeof i?i=a[r]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),!i.warned&&(o=f(e))&&o>0&&i.length>o){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+r+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=r,u.count=i.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else i=a[r]=t,++e._eventsCount;return e}function p(e,r,t){var n=!1;function o(){e.removeListener(r,o),n||(n=!0,t.apply(e,arguments))}return o.listener=t,o}function h(e){var r=this._events;if(r){var t=r[e];if("function"==typeof t)return 1;if(t)return t.length}return 0}function v(e,r){for(var t=new Array(r);r--;)t[r]=e[r];return t}c.prototype=Object.create(null),l.EventEmitter=l,l.usingDomains=!1,l.prototype.domain=void 0,l.prototype._events=void 0,l.prototype._maxListeners=void 0,l.defaultMaxListeners=10,l.init=function(){this.domain=null,l.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new c,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},l.prototype.getMaxListeners=function(){return f(this)},l.prototype.emit=function(e){var r,t,n,o,a,i,s,u="error"===e;if(i=this._events)u=u&&null==i.error;else if(!u)return!1;if(s=this.domain,u){if(r=arguments[1],!s){if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=s,r.domainThrown=!1,s.emit("error",r),!1}if(!(t=i[e]))return!1;var l="function"==typeof t;switch(n=arguments.length){case 1:!function(e,r,t){if(r)e.call(t);else for(var n=e.length,o=v(e,n),a=0;a<n;++a)o[a].call(t)}(t,l,this);break;case 2:!function(e,r,t,n){if(r)e.call(t,n);else for(var o=e.length,a=v(e,o),i=0;i<o;++i)a[i].call(t,n)}(t,l,this,arguments[1]);break;case 3:!function(e,r,t,n,o){if(r)e.call(t,n,o);else for(var a=e.length,i=v(e,a),s=0;s<a;++s)i[s].call(t,n,o)}(t,l,this,arguments[1],arguments[2]);break;case 4:!function(e,r,t,n,o,a){if(r)e.call(t,n,o,a);else for(var i=e.length,s=v(e,i),u=0;u<i;++u)s[u].call(t,n,o,a)}(t,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(n-1),a=1;a<n;a++)o[a-1]=arguments[a];!function(e,r,t,n){if(r)e.apply(t,n);else for(var o=e.length,a=v(e,o),i=0;i<o;++i)a[i].apply(t,n)}(t,l,this,o)}return!0},l.prototype.addListener=function(e,r){return d(this,e,r,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,r){return d(this,e,r,!0)},l.prototype.once=function(e,r){if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return this.on(e,p(this,e,r)),this},l.prototype.prependOnceListener=function(e,r){if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,p(this,e,r)),this},l.prototype.removeListener=function(e,r){var t,n,o,a,i;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(t=n[e]))return this;if(t===r||t.listener&&t.listener===r)0==--this._eventsCount?this._events=new c:(delete n[e],n.removeListener&&this.emit("removeListener",e,t.listener||r));else if("function"!=typeof t){for(o=-1,a=t.length;a-- >0;)if(t[a]===r||t[a].listener&&t[a].listener===r){i=t[a].listener,o=a;break}if(o<0)return this;if(1===t.length){if(t[0]=void 0,0==--this._eventsCount)return this._events=new c,this;delete n[e]}else!function(e,r){for(var t=r,n=t+1,o=e.length;n<o;t+=1,n+=1)e[t]=e[n];e.pop()}(t,o);n.removeListener&&this.emit("removeListener",e,i||r)}return this},l.prototype.removeAllListeners=function(e){var r,t;if(!(t=this._events))return this;if(!t.removeListener)return 0===arguments.length?(this._events=new c,this._eventsCount=0):t[e]&&(0==--this._eventsCount?this._events=new c:delete t[e]),this;if(0===arguments.length){for(var n,o=Object.keys(t),a=0;a<o.length;++a)"removeListener"!==(n=o[a])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new c,this._eventsCount=0,this}if("function"==typeof(r=t[e]))this.removeListener(e,r);else if(r)do{this.removeListener(e,r[r.length-1])}while(r[0]);return this},l.prototype.listeners=function(e){var r,t=this._events;return t&&(r=t[e])?"function"==typeof r?[r.listener||r]:function(e){for(var r=new Array(e.length),t=0;t<r.length;++t)r[t]=e[t].listener||e[t];return r}(r):[]},l.listenerCount=function(e,r){return"function"==typeof e.listenerCount?e.listenerCount(r):h.call(e,r)},l.prototype.listenerCount=h,l.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var g=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n={},o={},a=(r.addCustomErrorDeserializer=function(e,r){o[e]=r},r.createCustomErrorClass=function(e){var r=function(r,t){Object.assign(this,t),this.name=e,this.message=r||e,this.stack=(new Error).stack};return r.prototype=new Error,n[e]=r,r});r.deserializeError=function e(r){if("object"===(void 0===r?"undefined":t(r))&&r){try{var i=JSON.parse(r.message);i.message&&i.name&&(r=i)}catch(e){}var s=void 0;if("string"==typeof r.name){var u=r.name,c=o[u];if(c)s=c(r);else{var l="Error"===u?Error:n[u];l||(console.warn("deserializing an unknown class '"+u+"'"),l=a(u)),s=Object.create(l.prototype);try{for(var f in r)r.hasOwnProperty(f)&&(s[f]=r[f])}catch(e){}}}else s=new Error(r.message);return!s.stack&&Error.captureStackTrace&&Error.captureStackTrace(s,e),s}return new Error(String(r))},r.serializeError=function(e){return e?"object"===(void 0===e?"undefined":t(e))?function e(r,n){var o={};n.push(r);var a=!0;var i=!1;var s=void 0;try{for(var u,c=Object.keys(r)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=r[l];"function"!=typeof f&&(f&&"object"===(void 0===f?"undefined":t(f))?-1!==n.indexOf(r[l])?o[l]="[Circular]":o[l]=e(r[l],n.slice(0)):o[l]=f)}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}"string"==typeof r.name&&(o.name=r.name);"string"==typeof r.message&&(o.message=r.message);"string"==typeof r.stack&&(o.stack=r.stack);return o}(e,[]):"function"==typeof e?"[Function: "+(e.name||"anonymous")+"]":e:e}});t(g);g.addCustomErrorDeserializer,g.createCustomErrorClass,g.deserializeError,g.serializeError;var m=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.StatusCodes=r.DBNotReset=r.DBWrongPassword=r.NoDBPathGiven=r.FirmwareOrAppUpdateRequired=r.LedgerAPI5xx=r.LedgerAPI4xx=r.GenuineCheckFailed=r.PairingFailed=r.SyncError=r.FeeTooHigh=r.FeeRequired=r.FeeNotLoaded=r.CantScanQRCode=r.ETHAddressNonEIP=r.WrongAppForCurrency=r.WrongDeviceForAccount=r.WebsocketConnectionFailed=r.WebsocketConnectionError=r.DeviceShouldStayInApp=r.TransportWebUSBGestureRequired=r.TransportInterfaceNotAvailable=r.TransportOpenUserCancelled=r.UserRefusedOnDevice=r.UserRefusedAllowManager=r.UserRefusedFirmwareUpdate=r.UserRefusedAddress=r.UserRefusedDeviceNameChange=r.UpdateYourApp=r.UnavailableTezosOriginatedAccountSend=r.UnavailableTezosOriginatedAccountReceive=r.RecipientRequired=r.MCUNotGenuineToDashboard=r.UnexpectedBootloader=r.TimeoutTagged=r.RecommendUndelegation=r.RecommendSubAccountsToEmpty=r.PasswordIncorrectError=r.PasswordsDontMatchError=r.GasLessThanEstimate=r.NotSupportedLegacyAddress=r.NotEnoughGas=r.NoAccessToCamera=r.NotEnoughBalanceBecauseDestinationNotCreated=r.NotEnoughSpendableBalance=r.NotEnoughBalanceInParentAccount=r.NotEnoughBalanceToDelegate=r.NotEnoughBalance=r.NoAddressesFound=r.NetworkDown=r.ManagerUninstallBTCDep=r.ManagerNotEnoughSpaceError=r.ManagerFirmwareNotEnoughSpaceError=r.ManagerDeviceLockedError=r.ManagerAppDepUninstallRequired=r.ManagerAppDepInstallRequired=r.ManagerAppRelyOnBTCError=r.ManagerAppAlreadyInstalledError=r.LedgerAPINotAvailable=r.LedgerAPIErrorWithMessage=r.LedgerAPIError=r.UnknownMCU=r.LatestMCUInstalledError=r.InvalidAddressBecauseDestinationIsAlsoSource=r.InvalidAddress=r.InvalidXRPTag=r.HardResetFail=r.FeeEstimationFailed=r.EthAppPleaseEnableContractData=r.EnpointConfigError=r.DisconnectedDeviceDuringOperation=r.DisconnectedDevice=r.DeviceSocketNoBulkStatus=r.DeviceSocketFail=r.DeviceNameInvalid=r.DeviceHalted=r.DeviceInOSUExpected=r.DeviceOnDashboardUnexpected=r.DeviceOnDashboardExpected=r.DeviceNotGenuineError=r.DeviceGenuineSocketEarlyClose=r.DeviceAppVerifyNotSupported=r.CurrencyNotSupported=r.CashAddrNotSupported=r.CantOpenDevice=r.BtcUnmatchedApp=r.BluetoothRequired=r.AmountRequired=r.AccountNotSupported=r.AccountNameRequiredError=r.addCustomErrorDeserializer=r.createCustomErrorClass=r.deserializeError=r.serializeError=void 0,r.TransportError=t,r.getAltStatusMessage=o,r.TransportStatusError=a,r.serializeError=g.serializeError,r.deserializeError=g.deserializeError,r.createCustomErrorClass=g.createCustomErrorClass,r.addCustomErrorDeserializer=g.addCustomErrorDeserializer;r.AccountNameRequiredError=(0,g.createCustomErrorClass)("AccountNameRequired"),r.AccountNotSupported=(0,g.createCustomErrorClass)("AccountNotSupported"),r.AmountRequired=(0,g.createCustomErrorClass)("AmountRequired"),r.BluetoothRequired=(0,g.createCustomErrorClass)("BluetoothRequired"),r.BtcUnmatchedApp=(0,g.createCustomErrorClass)("BtcUnmatchedApp"),r.CantOpenDevice=(0,g.createCustomErrorClass)("CantOpenDevice"),r.CashAddrNotSupported=(0,g.createCustomErrorClass)("CashAddrNotSupported"),r.CurrencyNotSupported=(0,g.createCustomErrorClass)("CurrencyNotSupported"),r.DeviceAppVerifyNotSupported=(0,g.createCustomErrorClass)("DeviceAppVerifyNotSupported"),r.DeviceGenuineSocketEarlyClose=(0,g.createCustomErrorClass)("DeviceGenuineSocketEarlyClose"),r.DeviceNotGenuineError=(0,g.createCustomErrorClass)("DeviceNotGenuine"),r.DeviceOnDashboardExpected=(0,g.createCustomErrorClass)("DeviceOnDashboardExpected"),r.DeviceOnDashboardUnexpected=(0,g.createCustomErrorClass)("DeviceOnDashboardUnexpected"),r.DeviceInOSUExpected=(0,g.createCustomErrorClass)("DeviceInOSUExpected"),r.DeviceHalted=(0,g.createCustomErrorClass)("DeviceHalted"),r.DeviceNameInvalid=(0,g.createCustomErrorClass)("DeviceNameInvalid"),r.DeviceSocketFail=(0,g.createCustomErrorClass)("DeviceSocketFail"),r.DeviceSocketNoBulkStatus=(0,g.createCustomErrorClass)("DeviceSocketNoBulkStatus"),r.DisconnectedDevice=(0,g.createCustomErrorClass)("DisconnectedDevice"),r.DisconnectedDeviceDuringOperation=(0,g.createCustomErrorClass)("DisconnectedDeviceDuringOperation"),r.EnpointConfigError=(0,g.createCustomErrorClass)("EnpointConfig"),r.EthAppPleaseEnableContractData=(0,g.createCustomErrorClass)("EthAppPleaseEnableContractData"),r.FeeEstimationFailed=(0,g.createCustomErrorClass)("FeeEstimationFailed"),r.HardResetFail=(0,g.createCustomErrorClass)("HardResetFail"),r.InvalidXRPTag=(0,g.createCustomErrorClass)("InvalidXRPTag"),r.InvalidAddress=(0,g.createCustomErrorClass)("InvalidAddress"),r.InvalidAddressBecauseDestinationIsAlsoSource=(0,g.createCustomErrorClass)("InvalidAddressBecauseDestinationIsAlsoSource"),r.LatestMCUInstalledError=(0,g.createCustomErrorClass)("LatestMCUInstalledError"),r.UnknownMCU=(0,g.createCustomErrorClass)("UnknownMCU"),r.LedgerAPIError=(0,g.createCustomErrorClass)("LedgerAPIError"),r.LedgerAPIErrorWithMessage=(0,g.createCustomErrorClass)("LedgerAPIErrorWithMessage"),r.LedgerAPINotAvailable=(0,g.createCustomErrorClass)("LedgerAPINotAvailable"),r.ManagerAppAlreadyInstalledError=(0,g.createCustomErrorClass)("ManagerAppAlreadyInstalled"),r.ManagerAppRelyOnBTCError=(0,g.createCustomErrorClass)("ManagerAppRelyOnBTC"),r.ManagerAppDepInstallRequired=(0,g.createCustomErrorClass)("ManagerAppDepInstallRequired"),r.ManagerAppDepUninstallRequired=(0,g.createCustomErrorClass)("ManagerAppDepUninstallRequired"),r.ManagerDeviceLockedError=(0,g.createCustomErrorClass)("ManagerDeviceLocked"),r.ManagerFirmwareNotEnoughSpaceError=(0,g.createCustomErrorClass)("ManagerFirmwareNotEnoughSpace"),r.ManagerNotEnoughSpaceError=(0,g.createCustomErrorClass)("ManagerNotEnoughSpace"),r.ManagerUninstallBTCDep=(0,g.createCustomErrorClass)("ManagerUninstallBTCDep"),r.NetworkDown=(0,g.createCustomErrorClass)("NetworkDown"),r.NoAddressesFound=(0,g.createCustomErrorClass)("NoAddressesFound"),r.NotEnoughBalance=(0,g.createCustomErrorClass)("NotEnoughBalance"),r.NotEnoughBalanceToDelegate=(0,g.createCustomErrorClass)("NotEnoughBalanceToDelegate"),r.NotEnoughBalanceInParentAccount=(0,g.createCustomErrorClass)("NotEnoughBalanceInParentAccount"),r.NotEnoughSpendableBalance=(0,g.createCustomErrorClass)("NotEnoughSpendableBalance"),r.NotEnoughBalanceBecauseDestinationNotCreated=(0,g.createCustomErrorClass)("NotEnoughBalanceBecauseDestinationNotCreated"),r.NoAccessToCamera=(0,g.createCustomErrorClass)("NoAccessToCamera"),r.NotEnoughGas=(0,g.createCustomErrorClass)("NotEnoughGas"),r.NotSupportedLegacyAddress=(0,g.createCustomErrorClass)("NotSupportedLegacyAddress"),r.GasLessThanEstimate=(0,g.createCustomErrorClass)("GasLessThanEstimate"),r.PasswordsDontMatchError=(0,g.createCustomErrorClass)("PasswordsDontMatch"),r.PasswordIncorrectError=(0,g.createCustomErrorClass)("PasswordIncorrect"),r.RecommendSubAccountsToEmpty=(0,g.createCustomErrorClass)("RecommendSubAccountsToEmpty"),r.RecommendUndelegation=(0,g.createCustomErrorClass)("RecommendUndelegation"),r.TimeoutTagged=(0,g.createCustomErrorClass)("TimeoutTagged"),r.UnexpectedBootloader=(0,g.createCustomErrorClass)("UnexpectedBootloader"),r.MCUNotGenuineToDashboard=(0,g.createCustomErrorClass)("MCUNotGenuineToDashboard"),r.RecipientRequired=(0,g.createCustomErrorClass)("RecipientRequired"),r.UnavailableTezosOriginatedAccountReceive=(0,g.createCustomErrorClass)("UnavailableTezosOriginatedAccountReceive"),r.UnavailableTezosOriginatedAccountSend=(0,g.createCustomErrorClass)("UnavailableTezosOriginatedAccountSend"),r.UpdateYourApp=(0,g.createCustomErrorClass)("UpdateYourApp"),r.UserRefusedDeviceNameChange=(0,g.createCustomErrorClass)("UserRefusedDeviceNameChange"),r.UserRefusedAddress=(0,g.createCustomErrorClass)("UserRefusedAddress"),r.UserRefusedFirmwareUpdate=(0,g.createCustomErrorClass)("UserRefusedFirmwareUpdate"),r.UserRefusedAllowManager=(0,g.createCustomErrorClass)("UserRefusedAllowManager"),r.UserRefusedOnDevice=(0,g.createCustomErrorClass)("UserRefusedOnDevice"),r.TransportOpenUserCancelled=(0,g.createCustomErrorClass)("TransportOpenUserCancelled"),r.TransportInterfaceNotAvailable=(0,g.createCustomErrorClass)("TransportInterfaceNotAvailable"),r.TransportWebUSBGestureRequired=(0,g.createCustomErrorClass)("TransportWebUSBGestureRequired"),r.DeviceShouldStayInApp=(0,g.createCustomErrorClass)("DeviceShouldStayInApp"),r.WebsocketConnectionError=(0,g.createCustomErrorClass)("WebsocketConnectionError"),r.WebsocketConnectionFailed=(0,g.createCustomErrorClass)("WebsocketConnectionFailed"),r.WrongDeviceForAccount=(0,g.createCustomErrorClass)("WrongDeviceForAccount"),r.WrongAppForCurrency=(0,g.createCustomErrorClass)("WrongAppForCurrency"),r.ETHAddressNonEIP=(0,g.createCustomErrorClass)("ETHAddressNonEIP"),r.CantScanQRCode=(0,g.createCustomErrorClass)("CantScanQRCode"),r.FeeNotLoaded=(0,g.createCustomErrorClass)("FeeNotLoaded"),r.FeeRequired=(0,g.createCustomErrorClass)("FeeRequired"),r.FeeTooHigh=(0,g.createCustomErrorClass)("FeeTooHigh"),r.SyncError=(0,g.createCustomErrorClass)("SyncError"),r.PairingFailed=(0,g.createCustomErrorClass)("PairingFailed"),r.GenuineCheckFailed=(0,g.createCustomErrorClass)("GenuineCheckFailed"),r.LedgerAPI4xx=(0,g.createCustomErrorClass)("LedgerAPI4xx"),r.LedgerAPI5xx=(0,g.createCustomErrorClass)("LedgerAPI5xx"),r.FirmwareOrAppUpdateRequired=(0,g.createCustomErrorClass)("FirmwareOrAppUpdateRequired"),r.NoDBPathGiven=(0,g.createCustomErrorClass)("NoDBPathGiven"),r.DBWrongPassword=(0,g.createCustomErrorClass)("DBWrongPassword"),r.DBNotReset=(0,g.createCustomErrorClass)("DBNotReset");function t(e,r){this.name="TransportError",this.message=e,this.stack=(new Error).stack,this.id=r}t.prototype=new Error,(0,g.addCustomErrorDeserializer)("TransportError",function(e){return new t(e.message,e.id)});var n=r.StatusCodes={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586};function o(e){switch(e){case 26368:return"Incorrect length";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received"}if(28416<=e&&e<=28671)return"Internal error, please report"}function a(e){this.name="TransportStatusError";var r=Object.keys(n).find(function(r){return n[r]===e})||"UNKNOWN_ERROR",t=o(e)||r,a=e.toString(16);this.message="Ledger device: "+t+" (0x"+a+")",this.stack=(new Error).stack,this.statusCode=e,this.statusText=r}a.prototype=new Error,(0,g.addCustomErrorDeserializer)("TransportStatusError",function(e){return new a(e.statusCode)})});t(m);m.StatusCodes,m.DBNotReset,m.DBWrongPassword,m.NoDBPathGiven,m.FirmwareOrAppUpdateRequired,m.LedgerAPI5xx,m.LedgerAPI4xx,m.GenuineCheckFailed,m.PairingFailed,m.SyncError,m.FeeTooHigh,m.FeeRequired,m.FeeNotLoaded,m.CantScanQRCode,m.ETHAddressNonEIP,m.WrongAppForCurrency,m.WrongDeviceForAccount,m.WebsocketConnectionFailed,m.WebsocketConnectionError,m.DeviceShouldStayInApp,m.TransportWebUSBGestureRequired,m.TransportInterfaceNotAvailable,m.TransportOpenUserCancelled,m.UserRefusedOnDevice,m.UserRefusedAllowManager,m.UserRefusedFirmwareUpdate,m.UserRefusedAddress,m.UserRefusedDeviceNameChange,m.UpdateYourApp,m.UnavailableTezosOriginatedAccountSend,m.UnavailableTezosOriginatedAccountReceive,m.RecipientRequired,m.MCUNotGenuineToDashboard,m.UnexpectedBootloader,m.TimeoutTagged,m.RecommendUndelegation,m.RecommendSubAccountsToEmpty,m.PasswordIncorrectError,m.PasswordsDontMatchError,m.GasLessThanEstimate,m.NotSupportedLegacyAddress,m.NotEnoughGas,m.NoAccessToCamera,m.NotEnoughBalanceBecauseDestinationNotCreated,m.NotEnoughSpendableBalance,m.NotEnoughBalanceInParentAccount,m.NotEnoughBalanceToDelegate,m.NotEnoughBalance,m.NoAddressesFound,m.NetworkDown,m.ManagerUninstallBTCDep,m.ManagerNotEnoughSpaceError,m.ManagerFirmwareNotEnoughSpaceError,m.ManagerDeviceLockedError,m.ManagerAppDepUninstallRequired,m.ManagerAppDepInstallRequired,m.ManagerAppRelyOnBTCError,m.ManagerAppAlreadyInstalledError,m.LedgerAPINotAvailable,m.LedgerAPIErrorWithMessage,m.LedgerAPIError,m.UnknownMCU,m.LatestMCUInstalledError,m.InvalidAddressBecauseDestinationIsAlsoSource,m.InvalidAddress,m.InvalidXRPTag,m.HardResetFail,m.FeeEstimationFailed,m.EthAppPleaseEnableContractData,m.EnpointConfigError,m.DisconnectedDeviceDuringOperation,m.DisconnectedDevice,m.DeviceSocketNoBulkStatus,m.DeviceSocketFail,m.DeviceNameInvalid,m.DeviceHalted,m.DeviceInOSUExpected,m.DeviceOnDashboardUnexpected,m.DeviceOnDashboardExpected,m.DeviceNotGenuineError,m.DeviceGenuineSocketEarlyClose,m.DeviceAppVerifyNotSupported,m.CurrencyNotSupported,m.CashAddrNotSupported,m.CantOpenDevice,m.BtcUnmatchedApp,m.BluetoothRequired,m.AmountRequired,m.AccountNotSupported,m.AccountNameRequiredError,m.addCustomErrorDeserializer,m.createCustomErrorClass,m.deserializeError,m.serializeError,m.TransportError,m.getAltStatusMessage,m.TransportStatusError;var E=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getAltStatusMessage=r.StatusCodes=r.TransportStatusError=r.TransportError=void 0;var t,n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),o=(t=l)&&t.__esModule?t:{default:t};function a(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,a){try{var i=r[o](a),s=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}r.TransportError=m.TransportError,r.TransportStatusError=m.TransportStatusError,r.StatusCodes=m.StatusCodes,r.getAltStatusMessage=m.getAltStatusMessage;var i=function(){function e(){var r,t,n=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.exchangeTimeout=3e4,this._events=new o.default,this.send=(r=a(regeneratorRuntime.mark(function e(r,t,o,a){var i,s,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Buffer.alloc(0),c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[m.StatusCodes.OK];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u.length>=256)){e.next=2;break}throw new m.TransportError("data.length exceed 256 bytes limit. Got: "+u.length,"DataLengthTooBig");case 2:return e.next=4,n.exchange(Buffer.concat([Buffer.from([r,t,o,a]),Buffer.from([u.length]),u]));case 4:if(i=e.sent,s=i.readUInt16BE(i.length-2),c.some(function(e){return e===s})){e.next=8;break}throw new m.TransportStatusError(s);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,n)})),function(e,t,n,o){return r.apply(this,arguments)}),this.exchangeAtomicImpl=(t=a(regeneratorRuntime.mark(function e(r){var t,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.exchangeBusyPromise){e.next=2;break}throw new m.TransportError("Transport race condition","RaceCondition");case 2:return t=void 0,o=new Promise(function(e){t=e}),n.exchangeBusyPromise=o,e.prev=5,e.next=8,r();case 8:return a=e.sent,e.abrupt("return",a);case 10:return e.prev=10,t&&t(),n.exchangeBusyPromise=null,e.finish(10);case 14:case"end":return e.stop()}},e,n,[[5,,10,14]])})),function(e){return t.apply(this,arguments)}),this._appAPIlock=null}return n(e,[{key:"on",value:function(e,r){this._events.on(e,r)}},{key:"off",value:function(e,r){this._events.removeListener(e,r)}},{key:"emit",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];(r=this._events).emit.apply(r,[e].concat(function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}(n)))}},{key:"setDebugMode",value:function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}},{key:"setExchangeTimeout",value:function(e){this.exchangeTimeout=e}},{key:"decorateAppAPIMethods",value:function(e,r,t){var n=!0,o=!1,a=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;e[u]=this.decorateAppAPIMethod(u,e[u],e,t)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}},{key:"decorateAppAPIMethod",value:function(e,r,t,n){var o,i=this;return o=a(regeneratorRuntime.mark(function o(){for(var a=arguments.length,s=Array(a),u=0;u<a;u++)s[u]=arguments[u];var c;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(c=i._appAPIlock)){o.next=3;break}return o.abrupt("return",Promise.reject(new m.TransportError("Ledger Device is busy (lock "+c+")","TransportLocked")));case 3:return o.prev=3,i._appAPIlock=e,i.setScrambleKey(n),o.next=8,r.apply(t,s);case 8:return o.abrupt("return",o.sent);case 9:return o.prev=9,i._appAPIlock=null,o.finish(9);case 12:case"end":return o.stop()}},o,i,[[3,,9,12]])})),function(){return o.apply(this,arguments)}}}],[{key:"create",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3,t=arguments[1];return new Promise(function(n,o){var a=!1,i=e.listen({next:function(t){a=!0,i&&i.unsubscribe(),s&&clearTimeout(s),e.open(t.descriptor,r).then(n,o)},error:function(e){s&&clearTimeout(s),o(e)},complete:function(){s&&clearTimeout(s),a||o(new m.TransportError(e.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),s=t?setTimeout(function(){i.unsubscribe(),o(new m.TransportError(e.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}}]),e}();i.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",i.ErrorMessage_NoDeviceFound="No Ledger device found",r.default=i});t(E);E.getAltStatusMessage,E.StatusCodes,E.TransportStatusError,E.TransportError;var y=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t={data:Buffer.alloc(0),dataLength:0,sequence:0};r.default=function(e,r){return{makeBlocks:function(t){var n,o,a=Buffer.concat([(n=t.length,o=Buffer.alloc(2),o.writeUInt16BE(n,0),o),t]),i=r-5,s=Math.ceil(a.length/i);a=Buffer.concat([a,Buffer.alloc(s*i-a.length+1).fill(0)]);for(var u=[],c=0;c<s;c++){var l=Buffer.alloc(5);l.writeUInt16BE(e,0),l.writeUInt8(5,2),l.writeUInt16BE(c,3);var f=a.slice(c*i,(c+1)*i);u.push(Buffer.concat([l,f]))}return u},reduceResponse:function(r,n){var o=r||t,a=o.data,i=o.dataLength,s=o.sequence;if(n.readUInt16BE(0)!==e)throw new m.TransportError("Invalid channel","InvalidChannel");if(5!==n.readUInt8(2))throw new m.TransportError("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==s)throw new m.TransportError("Invalid sequence","InvalidSequence");r||(i=n.readUInt16BE(5)),s++;var u=n.slice(r?5:7);return(a=Buffer.concat([a,u])).length>i&&(a=a.slice(0,i)),{data:a,dataLength:i,sequence:s}},getReducedResult:function(e){if(e&&e.dataLength===e.data.length)return e.data}}}});t(y);var C=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n=(r.IIGenericHID=1,r.IIKeyboardHID=2,r.IIU2F=4,r.IICCID=8,r.IIWebUSB=16,{blue:{id:"blue",productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:491520,blockSize:4096},nanoS:{id:"nanoS",productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:327680,blockSize:4096},nanoX:{id:"nanoX",productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2097152,blockSize:4096,bluetoothSpec:[{serviceUuid:"d973f2e0-b19e-11e2-9e96-0800200c9a66",notifyUuid:"d973f2e1-b19e-11e2-9e96-0800200c9a66",writeUuid:"d973f2e2-b19e-11e2-9e96-0800200c9a66"},{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572"}]}}),o={Blue:"blue","Nano S":"nanoS","Nano X":"nanoX"},a=Object.values(n),i=(r.ledgerUSBVendorId=11415,r.getDeviceModel=function(e){var r=n[e];if(!r)throw new Error("device '"+e+"' does not exist");return r},r.identifyUSBProductId=function(e){var r=a.find(function(r){return r.legacyUsbProductId===e});if(r)return r;var t=e>>8;return a.find(function(e){return e.productIdMM===t})},r.identifyProductName=function(e){var r=o[e];return a.find(function(e){return e.id===r})},[]),s={};for(var u in n){var c=n[u],l=c.bluetoothSpec;if(l)for(var f=0;f<l.length;f++){var d=l[f];i.push(d.serviceUuid),s[d.serviceUuid]=s[d.serviceUuid.replace(/-/g,"")]=t({deviceModel:c},d)}}r.getBluetoothServiceUuids=function(){return i},r.getInfosForServiceUuid=function(e){return s[e.toLowerCase()]}});t(C);C.IIGenericHID,C.IIKeyboardHID,C.IIU2F,C.IICCID,C.IIWebUSB,C.ledgerUSBVendorId,C.getDeviceModel,C.identifyUSBProductId,C.identifyProductName,C.getBluetoothServiceUuids,C.getInfosForServiceUuid;var w=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=0,o=[],a=(t.log=function(e,r,t){var a={type:e,id:String(++n),date:new Date};r&&(a.message=r),t&&(a.data=t),function(e){for(var r=0;r<o.length;r++)try{o[r](e)}catch(e){console.error(e)}}(a)},t.listen=function(e){return o.push(e),function(){var r=o.indexOf(e);-1!==r&&(o[r]=o[o.length-1],o.pop())}});r.__ledgerLogsListen=a});t(w);w.log,w.listen;var I=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isSupported=r.getFirstLedgerDevice=r.getLedgerDevices=r.requestLedgerDevice=void 0;var t,n,o,a=r.requestLedgerDevice=(t=s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.usb.requestDevice({filters:u});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)}),i=r.getLedgerDevices=(n=s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.usb.getDevices();case 2:return r=e.sent,e.abrupt("return",r.filter(function(e){return e.vendorId===C.ledgerUSBVendorId}));case 4:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)});r.getFirstLedgerDevice=(o=s(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:if(!((r=e.sent).length>0)){e.next=5;break}return e.abrupt("return",r[0]);case 5:return e.abrupt("return",a());case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)});function s(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,a){try{var i=r[o](a),s=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var u=[{vendorId:C.ledgerUSBVendorId}];r.isSupported=function(){return Promise.resolve(!!navigator&&!!navigator.usb&&"function"==typeof navigator.usb.getDevices)}});t(I);I.isSupported,I.getFirstLedgerDevice,I.getLedgerDevices,I.requestLedgerDevice;var b=n(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),n=a(E),o=a(y);function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,a){try{var i=r[o](a),s=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var s=function(e){function r(e,t){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return u.call(n),n.device=e,n.interfaceNumber=t,n.deviceModel=(0,C.identifyUSBProductId)(e.productId),n}return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}(r,n.default),t(r,[{key:"close",value:function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.exchangeBusyPromise;case 2:return e.next=4,this.device.releaseInterface(this.interfaceNumber);case 4:return e.next=6,this.device.reset();case 6:return e.next=8,this.device.close();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setScrambleKey",value:function(){}}],[{key:"request",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.requestLedgerDevice)();case 2:return t=e.sent,e.abrupt("return",r.open(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"openConnected",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.getLedgerDevices)();case 2:if(0!==(t=e.sent).length){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",r.open(t[0]));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"open",value:function(){var e=i(regeneratorRuntime.mark(function e(t){var n,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.open();case 2:if(null!==t.configuration){e.next=5;break}return e.next=5,t.selectConfiguration(1);case 5:return e.next=7,t.reset();case 7:if(n=t.configurations[0].interfaces.find(function(e){return e.alternates.some(function(e){return 255===e.interfaceClass})})){e.next=10;break}throw new m.TransportInterfaceNotAvailable("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");case 10:return o=n.interfaceNumber,e.prev=11,e.next=14,t.claimInterface(o);case 14:e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(11),e.next=20,t.close();case 20:throw new m.TransportInterfaceNotAvailable(e.t0.message);case 21:return a=new r(t,o),i=function e(r){t===r.device&&(navigator.usb.removeEventListener("disconnect",e),a._emitDisconnect(new m.DisconnectedDevice))},navigator.usb.addEventListener("disconnect",i),e.abrupt("return",a);case 25:case"end":return e.stop()}},e,this,[[11,16]])}));return function(r){return e.apply(this,arguments)}}()}]),r}();s.isSupported=I.isSupported,s.list=I.getLedgerDevices,s.listen=function(e){var r=!1;return(0,I.getFirstLedgerDevice)().then(function(t){if(!r){var n=(0,C.identifyUSBProductId)(t.productId);e.next({type:"add",descriptor:t,deviceModel:n}),e.complete()}},function(r){window.DOMException&&r instanceof window.DOMException&&18===r.code?e.error(new m.TransportWebUSBGestureRequired(r.message)):e.error(new m.TransportOpenUserCancelled(r.message))}),{unsubscribe:function(){r=!0}}};var u=function(){var e=this;this.channel=Math.floor(65535*Math.random()),this.packetSize=64,this._disconnectEmitted=!1,this._emitDisconnect=function(r){e._disconnectEmitted||(e._disconnectEmitted=!0,e.emit("disconnect",r))},this.exchange=function(r){return e.exchangeAtomicImpl(i(regeneratorRuntime.mark(function t(){var n,a,i,s,u,c,l,f,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.channel,a=e.packetSize,(0,w.log)("apdu","=> "+r.toString("hex")),i=(0,o.default)(n,a),s=i.makeBlocks(r),u=0;case 5:if(!(u<s.length)){t.next=12;break}return(0,w.log)("hid-frame","=> "+s[u].toString("hex")),t.next=9,e.device.transferOut(3,s[u]);case 9:u++,t.next=5;break;case 12:c=void 0,l=void 0;case 14:if(c=i.getReducedResult(l)){t.next=23;break}return t.next=17,e.device.transferIn(3,a);case 17:f=t.sent,d=Buffer.from(f.data.buffer),(0,w.log)("hid-frame","<= "+d.toString("hex")),l=i.reduceResponse(l,d),t.next=14;break;case 23:return(0,w.log)("apdu","<= "+c.toString("hex")),t.abrupt("return",c);case 25:case"end":return t.stop()}},t,e)}))).catch(function(r){if(r&&r.message&&r.message.includes("disconnected"))throw e._emitDisconnect(r),new m.DisconnectedDeviceDuringOperation(r.message);throw r})}};r.default=s}),B=t(b),D=Object.freeze({default:B,__moduleExports:b});e.Btc=u,e.TransportWebUSB=D,Object.defineProperty(e,"__esModule",{value:!0})});

window.Btc = NewLedger.Btc.default;
window.TransportWebUSB = NewLedger.TransportWebUSB.default;